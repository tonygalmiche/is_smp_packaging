<?xml version="1.0" encoding="UTF-8" ?>
<odoo>


    <template id="is_report_delivery_document" name="is_report_delivery_document" inherit_id="sale_stock.report_delivery_document_inherit_sale_stock">
        <xpath expr="//div[@class='page']" position="replace">
            <div class="page">
                <style>
                    .thbleu{
                        text-align:center;
                        border: 1px solid black;
                        padding:1mm;
                        background-color:#EFF0F0;
                    }

                   .thorange{
                        text-align:center;
                        border: 1px solid black;
                        padding:1mm;
                        background-color:orange;
                    }
                    .table-border{
                        border: 1px solid black;
                    }

                    .td-border{
                        border-left: 1px solid black;
                        border-right: 1px solid black;
                    }
                    .no-border{
                        border: 0px;
                    }



                </style>


                <div style="display:none">
                    <div class="row" name="customer_address" >
                        <div class="col-xs-4 pull-right">
                            <div>
                                <span><strong>Customer Address:</strong></span>
                            </div>
                            <div t-if="o.move_lines and o.move_lines[0].partner_id" name="partner_header">
                                <div t-field="o.move_lines[0].partner_id"
                                   t-options='{"widget": "contact", "fields": ["address", "name", "phone", "fax"], "no_marker": True}'/>
                            </div>
                            <div t-if="not (o.move_lines and o.move_lines[0].partner_id) and o.partner_id" name="partner_header">
                                <div t-field="o.partner_id"
                                   t-options='{"widget": "contact", "fields": ["address", "name", "phone", "fax"], "no_marker": True}'/>
                            </div>
                        </div>
                    </div>
                </div>


                <table style="width:100%">
                    <tr>
                        <td style="width:45%">
                            <table class="table table-condensed table-border">
                                <tbody>
                                    <tr>
                                        <td style="border-top: 1px solid black" class="td-border text-center">CLIENT-CUSTOMER : <span t-field="o.partner_id.is_code_client"/></td>
                                    </tr>
                                    <tr>
                                        <td class="td-border text-center">REF : votre commande <span t-field="o.sale_id.client_order_ref"/></td>
                                    </tr>
                                 </tbody>
                            </table>
                        </td>
                        <td style="width:10%">
                        </td>
                       <td style="width:45%">
                            <table class="table table-condensed table-border">
                                <tbody>
                                    <tr>
                                        <td style="border-top: 1px solid black" class="thbleu text-center">LISTE DE COLISAGE - PACKING LIST</td>
                                    </tr>
                                    <tr>
                                        <td class="td-border text-center">BL n° <span t-field="o.name"/> du <span t-field="o.is_date_bl"/></td>
                                    </tr>
                                 </tbody>
                            </table>
                        </td>
                    </tr>
                </table>


                <table class="table table-condensed table-border">
                    <thead>
                        <tr>
                            <th colspan="3" class="thbleu">
                                Description des marchandises - List of goods
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr t-if="o.is_conditionnement">
                            <td style="width:50%" class="text-right"><b><span t-field="o.is_conditionnement"/> : </b></td>
                            <td style="width:10%" ></td>
                            <td style="width:40%" ></td>
                        </tr>
                        <tr t-if="o.is_longueur"><td class="text-right">dimensions :       long. - length :      </td><td class="text-right"><span t-field="o.is_longueur"/></td><td>cm</td></tr>
                        <tr t-if="o.is_largeur"><td class="text-right">larg. - width :                          </td><td class="text-right"><span t-field="o.is_largeur"/></td><td>cm</td></tr>
                        <tr t-if="o.is_hauteur"><td class="text-right">haut. - height :                         </td><td class="text-right"><span t-field="o.is_hauteur"/></td><td>cm</td></tr>
                        <tr t-if="o.is_poids"><td class="text-right">poids. - weight :                        </td><td class="text-right"><span t-field="o.is_poids"/></td><td>kg</td></tr>
                        <tr><td class="text-right"><b>comprenant - including : </b></td><td></td><td></td></tr>
                    </tbody>
                </table>



                <table class="table table-condensed table-border" style="display:none">
                    <thead>
                        <tr>
                            <th t-if="o.origin"><strong>Order (Origin)</strong></th>
                            <th name="td_sched_date_h">
                                <strong>Date</strong>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td t-if="o.origin">
                                <span t-field="o.origin"/>
                            </td>
                            <td name="td_sched_date">
                               <t t-if="o.state == 'done'">
                                    <span t-field="o.date_done"/>
                               </t>
                               <t t-if="o.state != 'done'">
                                    <span t-field="o.min_date"/>
                               </t>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <!--
                <table class="table table-condensed mt48 table-border" t-if="not o.pack_operation_ids">
                    <thead>
                        <tr>
                            <th class="thorange">Product</th>
                            <th class="thorange">Ordered Quantity</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr t-foreach="o.move_lines" t-as="move">
                            <td><span t-field="move.product_id"/></td>
                            <td>
                                <span t-field="move.ordered_qty"/>
                                <span t-field="move.product_uom"/>
                            </td>
                        </tr>
                    </tbody>
                </table>
                -->
                <t t-set="backorder" t-value="False"/>
                <table class="table table-condensed mt48 table-border" t-if="o.pack_operation_ids">
                    <t t-set="has_serial_number" t-value="o.pack_operation_ids.filtered('pack_lot_ids')" groups="stock.group_production_lot"/>
                    <thead>
                        <tr>

                            <!--
                            <th class="thorange text-center" t-if="any([pack_operation.state == 'done' for pack_operation in o.pack_operation_ids])">
                                    <strong>QTÉ - QTY</strong>
                            </th>
                            -->


                            <th class="thorange text-center">QTÉ-QTY</th>
                            <th class="thorange">DÉSIGNATION - DESIGNATION</th>

                            <!--
                            <th class="thorange" name="lot_serial" t-if="has_serial_number">
                                <span class="pull-left">Lot/Serial Number</span>
                            </th>
                            -->


                        </tr>
                    </thead>
                    <tbody>

                        <tr t-if="o.is_description_haut">
                            <td>
                            </td>
                            <td style="background-color:#FFFFCC;text-align:center">
                                <b><span  t-field="o.is_description_haut"/></b>
                            </td>
                        </tr>



                        <tr t-foreach="o.pack_operation_ids" t-as="pack_operation">

                            <!--
                            <td class="td-border text-right" t-if="pack_operation.state == 'done'">
                                <t t-if="pack_operation.ordered_qty != pack_operation.qty_done_uom_ordered">
                                    <t t-set="backorder" t-value="True"/>
                                </t>
                                <span t-field="pack_operation.qty_done_uom_ordered"/>
                                <t t-if="pack_operation.linked_move_operation_ids">
                                    <span t-field="pack_operation.linked_move_operation_ids[0].move_id.product_uom"></span>
                                </t>
                                <t t-else="1">
                                    <span t-field="pack_operation.product_uom_id"></span>
                                </t>
                            </td>
                            -->


                            <td class="td-border text-center">
                                <span t-if="pack_operation.package_id">:</span>
                                <span t-field="pack_operation.package_id"/>

                                <t t-if="pack_operation.qty_done">
                                    <t t-set="qt" t-value="str(pack_operation.qty_done)"/>
                                </t>
                                <t t-else="1">
                                    <t t-set="qt" t-value="str(pack_operation.ordered_qty)"/>
                                </t>
                                <t t-set="nb" t-value="len(qt)"/>
                            
                                <t t-if="qt[-2:]=='.0'">
                                    <t t-esc="qt[0:nb-2]"/>
                                </t>
                                <t t-else="1">
                                    <span t-field="pack_operation.qty_done"/>
                                </t>

                                <!--
                                <t t-if="pack_operation.linked_move_operation_ids">
                                    <span t-field="pack_operation.linked_move_operation_ids[0].move_id.product_uom"></span>
                                </t>
                                <t t-else="1">
                                    <span t-field="pack_operation.product_uom_id"></span>
                                </t>
                                -->
                            </td>





                            <td class="td-border">
                                <span t-field="pack_operation.product_id.default_code"/> 
                                <span t-field="pack_operation.product_id.name"/>
                                <t t-if="pack_operation.is_designation">
                                    <span t-field="pack_operation.is_designation"/>
                                </t>


                                <!--
                                <t t-if="not pack_operation.product_id and pack_operation.package_id">
                                    <span  t-field="pack_operation.package_id"/>
                                </t>
                                -->
                            </td>

                            <!--
                            <t t-if="has_serial_number">
                                <td class="td-border" t-if="pack_operation.pack_lot_ids">
                                    <table class="table table-condensed" t-if="pack_operation.pack_lot_ids">
                                        <tr t-foreach="pack_operation.pack_lot_ids" t-as="packlot">
                                            <td>
                                                <span t-field="packlot.lot_id"/>
                                                <t t-if="not packlot.lot_id">
                                                    <span t-field="packlot.lot_name"/>
                                                </t>
                                            </td>
                                            <td name="lot_qty">
                                                <span t-field="packlot.qty"/>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td class="td-border" t-if="not pack_operation.pack_lot_ids"/>
                            </t>
                            -->


                        </tr>

                        <tr t-if="o.is_description_bas">
                            <td>
                            </td>
                            <td>
                                <span style="color:blue" t-field="o.is_description_bas"/>
                                <t t-if="o.is_signature">
                                    <div><img t-att-src="'/is_smp_packaging/static/img/signature-direction.jpg'" style="max-height: 30mm;"/></div>
                                </t>
                            </td>
                        </tr>



                    </tbody>
                </table>
                <!--
                <p t-if="o.backorder_id">
                    This shipment is a backorder of <t t-esc="o.backorder_id.name"/>.
                </p>
                <p>
                    <t t-if="backorder">
                        All items couldn't be shipped, the remaining ones will be shipped as soon as they become available.
                    </t>
                </p>
                -->
            </div>
        </xpath>
    </template>


<!--
    <template id="is_report_delivery_document_inherit_sale_stock" inherit_id="sale_stock.report_delivery_document_inherit_sale_stock">
        <xpath expr="//div" position="replace"/>
    </template>
-->

    <!--
    <template id="report_delivery_document_inherit_sale_stock" inherit_id="stock.report_delivery_document">
        <xpath expr="//div[@name='customer_address']" position="after">
            <div class="row" t-if="o.sale_id.client_order_ref">
                <div class="col-xs-4 pull-right">
                    <strong>Customer Reference:</strong>
                    <p t-field="o.sale_id.client_order_ref"/>
                </div>
            </div>
        </xpath>
    </template>
    -->




</odoo>
